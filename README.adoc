= kubernetes-embedded-hazelcast

The library provides closed in pods kubernetes cluster for one service with Spring Cache implementation.

[source,xml]
----
<dependency>
  <groupId>io.github.sevenparadigms</groupId>
  <artifactId>kubernetes-embedded-hazelcast</artifactId>
  <version>1.1.1</version>
</dependency>
----

Properties in application.yml:
[source,yaml]
----
hazelcast:
    kubernetes: false
    timeoutMinutes: 5
    namespace: default
    serviceName:
----

Service name can also get from: `spring.application.name` if property `serviceName` is empty. All properties have default values and do not require.

Each cache by name can have own properties:
[source,yaml]
----
spring.cache:
  <cache name>.expireAfterAccess: 500 # milliseconds
  <cache name>.expireAfterWrite: 1000 # milliseconds
  <cache name>.maximumSize: 10000
----

Kubernetes yaml:
[source,yaml]
----
apiVersion: apps/v1
kind: Deployment
metadata:
  name: employee-service
  labels:
    app: employee-service
spec:
  replicas: 2
  selector:
    matchLabels:
      app: employee-service
  template:
    metadata:
      labels:
        app: employee-service
    spec:
      containers:
        - name: employee-service
          image: piomin/employee-service
          ports:
            - name: http
              containerPort: 8080
            - name: multicast
              containerPort: 5701
---
apiVersion: v1
kind: Service
metadata:
  name: employee-service
  labels:
    app: employee-service
spec:
  ports:
    - port: 8080
      protocol: TCP
  selector:
    app: employee-service
  type: NodePort
----